if not listexists "harvest_actions"
    createlist "harvest_actions"
endif

while not findbuff "Tracking Hunting"
    skill 'tracking'
    waitforgump 4267467659
    gumpresponse 6
    waitforgump 4267467659
    gumpclose
endwhile

// Recall conditions
if inlist "harvest_actions" "escape"
        // Explosion Pouch
    if paralyzed
        overhead 'Paralyzed!' 38
        if findtype "pouch" backpack 38 any any 
            say '[pouch'
            wait 100
        else
            overhead "Out of Trap Pouch" 34
        endif 
    endif

    say '[recall house'
    clearlist "harvest_actions"
    stop
endif

if insysmsg "Now tracking"
    overhead "Red Alert!" 34
    pushlist "harvest_actions" "escape"
    replay
endif

if diffweight <= 30
    overhead "Overweight" 34
    pushlist "harvest_actions" "escape"
    replay
endif

// Magery Stuff
if inlist "harvest_actions" "summon"
    overhead "Summoning Friends" 34
    cast "Water Elemental"
    wait 5000
    say "All Guard Me"
endif

if inlist "harvest_actions" "buff"
     if not findbuff "Magic Reflection" and mana > 40
        cast "Magic Reflection"
        wait 2000
    endif

    if not findbuff "Reactive Armor" and mana > 40
        cast "Reactive Armor"
        wait 2000
    endif
endif

// Wait condictions
if inlist "harvest_actions" "sav2e"
    for 30
        overhead 'Waiting for world save...'
        wait 500
        if insysmsg 'save complete'
            overhead 'Save complete - continue on!' 88
            wait 250
            replay
        elseif insysmsg "now tracking"
            pushlist "harvest_actions" "escape"
            wait 250
            replay
        endif
    endfor
endif

clearsysmsg
clearlist "harvest_actions"
while not dead
    if insysmsg 'world is saving'
     pushlist "harvest_actions" "save"
         replay
    endif

    if insysmsg "Now tracking"
        overhead "Red Alert!" 34
        pushlist "harvest_actions" "escape"
        replay
    endif

    if lhandempty ?? 0 
        if findtype "hatchet" backpack
            dclicktype 'hatchet' backpack
            wait 200
        elseif findtype "pickaxe" backpack
             dclicktype "pickaxe" backpack
             wait 200
        else
            overhead "No more tools!" 34
            pushlist "harvest_actions" "escape"
            replay
        endif
    endif

    overhead 'Harvesting' 0
    hotkey 'Use item in hand'
    wft 200
    target self

    if insysmsg "Now tracking"
        overhead "Red Alert!" 34
        pushlist "harvest_actions" "escape"
        replay
    endif

    if insysmsg 'You do not see any' or insysmsg 'You cannot produce any wood'
        overhead 'Move to next spot' 88
        wait 250
    endif

    if insysmsg "travel"
        overhead 'Waiting for travel...'
        wait 1000
    endif

    if followers = 0
        pushlist "harvest_actions" "summon"
        replay
    endif

    if not findbuff "Magic Reflection" or not findbuff "Reactive Armor"
        pushlist "harvest_actions" "buff"
        replay
    endif
endwhile